<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="backend.js"></script>
    <script src="json/militaryJson.js"></script>
    <link href="index.css" rel="stylesheet">
    <title>Title</title>
</head>
<body onload="main()">
    <div id="military_line_vis"></div>
    <div id="social_line_vis"></div>
</body>

<script>    
    var ml_margin = {top: 10, right: 30, bottom: 60, left: 70},
    ml_width = 1000 - ml_margin.left - ml_margin.right,
    ml_height = 520 - ml_margin.top - ml_margin.bottom;


    /*** Military Bar Graph ***/

    // Append SVG
    var ml_svg = d3.select("#military_line_vis")
    .append("svg")
        .attr("width", ml_width + ml_margin.left + ml_margin.right)
        .attr("height", ml_height + ml_margin.top + ml_margin.bottom)
    .append("g")
        .attr("transform",
            "translate(" + ml_margin.left + "," + ml_margin.top + ")");

    // X axis
    var ml_x = d3.scaleBand()
        .domain([2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021])
        .range([0, ml_width])
        .paddingInner(0.1);
    ml_svg.append("g")
        .attr("transform", "translate(0," + ml_height + ")")
        .call(d3.axisBottom(ml_x).tickValues([2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021]).tickFormat(d3.format("d")));
    ml_svg.append("text")
        .attr("x", ml_width/2)
        .attr("y", ml_height + ml_margin.bottom)
        .style("text-anchor", "middle")
        .attr("class", "label")
        .text("Years")

    // Y axis
    var ml_y = d3.scaleLinear()
       .domain([300, 1100])
        .range([ ml_height, 0 ]);
    ml_svg.append("g")
        .call(d3.axisLeft(ml_y));
    ml_svg.append("text")
        .attr("y", 0 - ml_margin.left)
        .attr("x",0 - (ml_height / 2))
        .attr("dy", "1em")
        .attr("transform", "rotate(-90)")
        .attr("class", "label")
        .style("text-anchor", "middle")
        .text("Total Military Spending in Billions (USD)")

    // Bars   
    ml_svg.selectAll("bar")
        .data(militaryData)
        .enter()
        .append("rect")
            .attr("x", function (d) { return ml_x(d.year) })
            .attr("y", function (d) { return ml_y(d.budget) })
            .attr("width", ml_x.bandwidth())
            .attr("height", function(d) { return ml_height - ml_y(d.budget) })
            .style("padding", "5px")
            .style("fill", "#005CB8") 
        .on("mouseover", function(d, i) {
            d3.select(this)
            	.style("fill", "#1AFFD5");
            ml_svg.append("text")
            .attr("x", ml_x(i.year))
            .attr("y", 490)
            .attr("class", "hoverLabel")
            .style("font-size", "14px")
            .style("font-weight", "bold")
            .text(i.budget + " B");
        })
        .on("mouseout", function() {
            d3.select(this)
            	.style("fill", "#005CB8");
            ml_svg.selectAll(".hoverLabel")
                .remove()
        })

    // 2003 text
    ml_svg.append("text")
        .attr("x", 53)
        .attr("y", 20)
        .attr("class", "label")
        .text("Start of")  
    ml_svg.append("text")
        .attr("x", 50)
        .attr("y", 40)
        .attr("class", "label")
        .text("Iraq War")
    ml_svg.append("text")
        .attr("x", 53)
        .attr("y", 60)
        .attr("class", "label")
        .text("(2003)")
    ml_svg.append('line')
        .attr('x1', 75)
        .attr('y1', 70)
        .attr('x2', 75)
        .attr('y2', 200)
    ml_svg.append('line')
        .attr('x1', 75)
        .attr('y1', 199.5)
        .attr('x2', 19.5)
        .attr('y2', 199.5) 
    ml_svg.append('line')
        .attr('x1', 20)
        .attr('y1', 199.5)
        .attr('x2', 20)
        .attr('y2', 373)

    // 2006 text
    ml_svg.append("text")
        .attr("x", 170)
        .attr("y", 20)
        .attr("class", "label")
        .text("Costs rise")
    ml_svg.append("text")
        .attr("x", 180)
        .attr("y", 40)
        .attr("class", "label")
        .text("in Iraq")
    ml_svg.append("text")
        .attr("x", 180)
        .attr("y", 60)
        .attr("class", "label")
        .text("(2006)")
    ml_svg.append('line')
        .attr('x1', 200)
        .attr('y1', 70)
        .attr('x2', 200)
        .attr('y2', 150)
    ml_svg.append('line')
        .attr('x1', 200)
        .attr('y1', 149.5)
        .attr('x2', 160)
        .attr('y2', 149.5)  
    ml_svg.append('line')
        .attr('x1', 160.5)
        .attr('y1', 150)
        .attr('x2', 160.5)
        .attr('y2', 256.5)

    // 2011 text
    ml_svg.append("text")
        .attr("x", 295)
        .attr("y", 40)
        .attr("class", "label")
        .text("Iraq War ends")
    ml_svg.append("text")
        .attr("x", 317)
        .attr("y", 60)
        .attr("class", "label")
        .text("(2011)")
    ml_svg.append('line')
        .attr('x1', 335)
        .attr('y1', 70)
        .attr('x2', 335)
        .attr('y2', 110)
    ml_svg.append('line')
        .attr('x1', 335)
        .attr('y1', 110)
        .attr('x2', 400)
        .attr('y2', 110)  
    ml_svg.append('line')
        .attr('x1', 400)
        .attr('y1', 110)
        .attr('x2', 400)
        .attr('y2', 140)

    // 2012 text
    ml_svg.append("text")
        .attr("x", 455)
        .attr("y", 20)
        .attr("class", "label")
        .text("Troop withdrawal in")
    ml_svg.append("text")
        .attr("x", 465)
        .attr("y", 40)
        .attr("class", "label")
        .text("Afghanistan War")
    ml_svg.append("text")
        .attr("x", 495)
        .attr("y", 60)
        .attr("class", "label")
        .text("(2012)")
    ml_svg.append('line')
        .attr('x1', 515)
        .attr('y1', 70)
        .attr('x2', 515)
        .attr('y2', 130)
    ml_svg.append('line')
        .attr('x1', 515)
        .attr('y1', 130)
        .attr('x2', 450)
        .attr('y2', 130) 
    ml_svg.append('line')
        .attr('x1', 450)
        .attr('y1', 130)
        .attr('x2', 450)
        .attr('y2', 160)

    // 2016 text
    ml_svg.append("text")
        .attr("x", 635)
        .attr("y", 20)
        .attr("class", "label")
        .text("Resurgence")
    ml_svg.append("text")
        .attr("x", 646)
        .attr("y", 40)
        .attr("class", "label")
        .text("of ISIS")
    ml_svg.append("text")
        .attr("x", 647)
        .attr("y", 60)
        .attr("class", "label")
        .text("(2016)")
    ml_svg.append('line')
        .attr('x1', 665)
        .attr('y1', 70)
        .attr('x2', 665)
        .attr('y2', 120)
    ml_svg.append('line')
        .attr('x1', 665)
        .attr('y1', 120)
        .attr('x2', 640)
        .attr('y2', 120)  
    ml_svg.append('line')
        .attr('x1', 640)
        .attr('y1', 120)
        .attr('x2', 640)
        .attr('y2', 188)

    // 2018 text
    ml_svg.append("text")
        .attr("x", 775)
        .attr("y", 20)
        .attr("class", "label")
        .text("Trump requests")
    ml_svg.append("text")
        .attr("x", 765)
        .attr("y", 40)
        .attr("class", "label")
        .text("a spending increase")
    ml_svg.append("text")
        .attr("x", 800)
        .attr("y", 60)
        .attr("class", "label")
        .text("(2018)")
    ml_svg.append('line')
        .attr('x1', 820)
        .attr('y1', 70)
        .attr('x2', 820)
        .attr('y2', 80)
    ml_svg.append('line')
        .attr('x1', 820)
        .attr('y1', 80)
        .attr('x2', 735)
        .attr('y2', 80)  
    ml_svg.append('line')
        .attr('x1', 735)
        .attr('y1', 80)
        .attr('x2', 735)
        .attr('y2', 120)
        
</script>
</html>