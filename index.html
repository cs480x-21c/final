<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="https://d3js.org/d3.v6.min.js"></script>
    <script src="backend.js"></script>
    <script src="json/militaryJson.js"></script>
    <script src="json/socialJson.js"></script>
    <title>Title</title>
</head>
<body onload="main()">
    <div id="military_line_vis"></div>
    <div id="social_line_vis"></div>
</body>

<script>
    /*** Shared Variables ***/
    
    var margin = {top: 10, right: 30, bottom: 30, left: 60},
    width = 600 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom;

    var colorDict = {
        Japan: "red",
        UnitedStates: "blue",
        France: "green",
        Italy: "yellow",
        Switzerland: "orange"
    };

    function assignColor (country) {
        switch (country) {
            case "United States":
                return colorDict.UnitedStates
            case "Japan":
                return colorDict.Japan
            case "France":
                return colorDict.France
            case "Italy":
                return colorDict.Italy
            case "Switzerland":
                return colorDict.Switzerland
            default:
                return "black"
        };
    };



    /*** Military Line Graph ***/

    // Append SVG
    var ml_svg = d3.select("#military_line_vis")
    .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
    .append("g")
        .attr("transform",
            "translate(" + margin.left + "," + margin.top + ")");

    // X axis
    var ml_x = d3.scaleBand()
        .domain([1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019])
        .range([0, width]);
    ml_svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(ml_x).tickValues([1988,1990,1992,1994,1996,1998,2000,2002,2004,2006,2008,2010,2012,2014,2016,2018]).tickFormat(d3.format("d")));

    // Y axis
    var ml_y = d3.scaleLinear()
       .domain([0, 16])
        .range([ height, 0 ]);
    ml_svg.append("g")
        .call(d3.axisLeft(ml_y));

    // Dots in place of line for now     
    ml_svg.append('g')
        .selectAll("dot")
        .data(militaryData)
        .enter()
        .append("circle")
        .attr("cx", function (d) { return ml_x(d.year) })
        .attr("cy", function (d) { return ml_y(d.data) })
        .attr("r", 5 )
        .style("fill", function(d) { return assignColor(d.country) })

    // UGH cant get line to work  (commented out sections from here down)

        // ml_svg.append("path")
        // .data(militaryData)
        // .attr("class", "line")
        // .attr("stroke", "steelblue")
        // .attr("stroke-width", 1.5)
        // .attr("d", d3.line()
        //     .x(x(militaryData.year))
        //     .y(y(militaryData.data))
        // )

        // var valueLine  = d3.line()
        // .x(function(d) { console.log("ahh"); return x(d.year); })
        // .y(function(d) { return x(d.data); })

        // var line = d3.line()
        // .defined(d => !isNaN(d.data))
        // .x(d => x(d.year))
        // .y(d => y(d.data))


        // ml_svg.append("path")
        // .data(militaryData)
        // .attr("fill", "none")
        // .attr("stroke", "steelblue")
        // .attr("stroke-width", 1.5)
        // .attr("d", d3.line()
        //     .x(d => x(d.year))
        //     .y(d => y(d.data)));

    // militaryData.forEach(mData => {  

        // console.log(data)
        // ml_svg.append("path")
        //     .data([mData])
        //     .attr("class", "line")

        //     // .attr("fill", "none")
        //     .attr("stroke", "steelblue")
        //     .attr("stroke-width", 1.5)
        //     // .attr("stroke-width", function(d) { console.log(d.data) })
        //     .attr("d", 
        //         d3.line()
        //         .x(x(mData.year))
        //         .y(y(mData.data))
        //         )
    // })




    /*** Social Line Graph ***/

    // Append SVG
    var sl_svg = d3.select("#social_line_vis")
    .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
    .append("g")
        .attr("transform",
            "translate(" + margin.left + "," + margin.top + ")");

    // X axis
    var sl_x = d3.scaleBand()
        .domain([1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019])
        .range([0, width]);
    sl_svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(sl_x).tickValues([1990,1992,1994,1996,1998,2000,2002,2004,2006,2008,2010,2012,2014,2016,2018]).tickFormat(d3.format("d")));

    // Y axis
    var sl_y = d3.scaleLinear()
       .domain([0, 40])
        .range([ height, 0 ]);
    sl_svg.append("g")
        .call(d3.axisLeft(sl_y));

    // Dots in place of line for now     
    sl_svg.append('g')
        .selectAll("dot")
        .data(socialData)
        .enter()
        .append("circle")
        .attr("cx", function (d) { return sl_x(d.year) })
        .attr("cy", function (d) { return sl_y(d.data) })
        .attr("r", 5 )
        .style("fill", function(d) { return assignColor(d.country) })
    

</script>
</html>